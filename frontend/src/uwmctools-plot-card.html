<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">

<link rel="import" href="shared-styles.html">

<link rel="import" href="firebase-indexeddb-link.html">
<link rel="import" href="uwmctools-player.html">

<dom-module id="uwmctools-plot-card">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        padding: 20px;
      }

      paper-card {
        width: 100%;
      }

      paper-item {
        background-color: #fff;
      }

      .title {
        background-color: inherit;
      }
    </style>
    <firebase-indexeddb-link path="uwmctools/plots/data/[[plotId]]" data="{{plot}}"></firebase-indexeddb-link>

    <paper-card heading="[[plot.posX]]/[[plot.posZ]]">
      <paper-item>
        <uwmctools-player uuid="[[plot.owner]]"></uwmctools-player>
      </paper-item>
      <paper-item>
        [[zoneSize(plot.pos)]] Bl√∂cke ([[zoneWidth(plot.pos)]]*[[zoneHeight(plot.pos)]])
      </paper-item>
      <paper-item>
        [[zoneCenterX(plot.pos)]] / [[zoneCenterZ(plot.pos)]]
      </paper-item>
      <paper-item>
        Erstellt: [[timestampToDate(plot.created)]]
      </paper-item>
      <paper-item class="title">Trusted:</paper-item>
      <template is="dom-repeat" items="[[plot.trusted]]">
        <paper-item><uwmctools-player uuid="[[item]]"></uwmctools-player></paper-item>
      </template>
    </paper-card>   
  </template>

  <script>
    Polymer({
      is: 'uwmctools-plot-card',
      properties: {
        zoneId: {
          type: String,
          value: "" 
        },
      },
      zoneSize(pos){
        if(!pos) return 0;

        return (pos.x2 - pos.x1) * (pos.z2 - pos.z1);
      },
      zoneWidth(pos){
        if(!pos) return 0;
          
        return pos.x2 - pos.x1;
      },
      zoneHeight(pos){
        if(!pos) return 0;
          
        return pos.z2 - pos.z1;
      },
      zoneCenterX(pos){
        if(!pos) return 0;
          
        return Math.floor(pos.x1 + (pos.x2 - pos.x1) / 2);
      },
      zoneCenterZ(pos){
        if(!pos) return 0;
          
        return Math.floor(pos.z1 + (pos.z2 - pos.z1) / 2);
      },
      timestampToDate(timestamp){
        return new Date(parseInt(timestamp)).toLocaleDateString();
      }
    });
  </script>
</dom-module>
